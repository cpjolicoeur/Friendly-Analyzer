<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MFL Friendly Match Analyzer</title>
  <link rel="stylesheet" href="css/app.css" />
</head>
<body>
  <div class="header">
    <h1>âš½ MFL Friendly Match Analyzer</h1>
    <p>Comprehensive team and player performance analysis across friendly matches</p>
  </div>

  <div class="controls">
    <div class="control-row">
      <div class="form-group">
        <label class="form-label">Club ID</label>
        <input type="text" id="club-id" class="form-input" placeholder="Enter club ID (e.g., 4036)..." />
      </div>

      <div class="form-group">
        <label class="form-label">Number of Games (Max 200)</label>
        <input type="number" id="game-limit" class="form-input" placeholder="50" min="1" max="200" value="50" />
      </div>

      <button id="load-btn" class="btn btn-primary">Load Matches</button>
    </div>

    <div class="add-match-section">
      <div class="control-row">
        <div class="form-group">
          <label class="form-label">Add Match by ID</label>
          <input type="text" id="match-id-input" class="form-input" placeholder="Enter match ID..." />
        </div>

        <button id="add-match-btn" class="btn btn-secondary">Add Match</button>
      </div>
    </div>

    <div class="analysis-actions">
      <button id="save-analysis-btn" class="btn btn-success" disabled>ğŸ’¾ Save Analysis</button>
      <button id="compare-analyses-btn" class="btn btn-info">ğŸ“Š Compare Analyses</button>
    </div>
  </div>

  <div id="status-container" class="status-container" aria-live="polite">
    <div class="status-content">
      <div class="status-row">
        <div class="status-indicator" aria-hidden="true"></div>
        <div class="status-texts">
          <div id="status" class="status-text">Enter a club ID to start analyzing friendly matches</div>
          <div id="status-detail" class="status-detail"></div>
        </div>
      </div>
      <div class="status-progress">
        <div id="status-progress-bar" class="status-progress-bar"></div>
      </div>
      <div id="status-meta" class="status-meta"></div>
    </div>
  </div>

  <div id="save-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Save Analysis</h3>
        <button class="modal-close" onclick="closeSaveModal()">&times;</button>
      </div>
      <div class="modal-body">
        <label class="form-label">Analysis Name</label>
        <input type="text" id="analysis-name-input" class="modal-input" placeholder="e.g., Pre-Season Training, January 2026..." />
        <button onclick="confirmSaveAnalysis()" class="btn btn-success" style="width: 100%">Save</button>
      </div>
    </div>
  </div>

  <div id="compare-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Select Analyses to Compare</h3>
        <button class="modal-close" onclick="closeCompareModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 16px; color: #94a3b8;">Select two saved analyses to compare side by side</p>
        <div id="saved-analyses-list" class="saved-analyses-list"></div>
        <button onclick="confirmCompareAnalyses()" class="btn btn-info" style="width: 100%" id="confirm-compare-btn" disabled>Compare Selected</button>
      </div>
    </div>
  </div>

  <div id="comparison-view" class="comparison-view">
    <div class="comparison-header">
      <h2>ğŸ“Š Analysis Comparison</h2>
      <div class="comparison-names">
        <div class="comparison-name-item" id="comparison-name-1">Analysis 1</div>
        <div class="comparison-name-item">vs</div>
        <div class="comparison-name-item" id="comparison-name-2">Analysis 2</div>
      </div>
      <div style="margin-top: 16px">
        <button id="close-comparison-btn" class="btn btn-secondary">â† Back to Main View</button>
      </div>
    </div>

    <div id="comparison-content" class="comparison-grid"></div>
  </div>

  <div id="overview-section" class="overview-section">
    <div class="record-summary" id="record-summary">
      <h3>ğŸ“Š Match Record</h3>
      <div class="record-stats">
        <div class="record-item wins">
          <div class="record-label">Wins</div>
          <div class="record-value" id="win-percentage">0%</div>
        </div>
        <div class="record-item draws">
          <div class="record-label">Draws</div>
          <div class="record-value" id="draw-percentage">0%</div>
        </div>
        <div class="record-item losses">
          <div class="record-label">Losses</div>
          <div class="record-value" id="loss-percentage">0%</div>
        </div>
      </div>
    </div>

    <div class="team-overview-wrapper">
      <div class="overview-card">
        <div class="overview-title">ğŸ  Home Team Performance</div>
        <div class="overview-subtitle" id="home-overview-subtitle">Averages across all matches</div>
        <div id="home-stats" class="stat-grid"></div>
        <div id="home-xi-summary" class="xi-overall-summary"></div>
      </div>

      <div class="overview-card">
        <div class="overview-title">âœˆï¸ Away Team Average Performance</div>
        <div class="overview-subtitle" id="away-overview-subtitle">Opponent averages</div>
        <div id="away-stats" class="stat-grid"></div>
        <div id="away-xi-summary" class="xi-overall-summary"></div>
      </div>
    </div>

    <div class="player-detail-card">
      <div class="overview-title">ğŸ‘¥ Player Performance Detail</div>
      <div class="overview-subtitle" id="player-detail-subtitle">Individual stats for all home players</div>
      
      <div class="player-table-controls">
        <div class="player-table-controls-left">
          <button id="restore-all-rows-btn" class="btn btn-secondary btn-small">â†» Restore All Rows</button>
          <button id="restore-all-cols-btn" class="btn btn-secondary btn-small">â†» Restore All Columns</button>
        </div>
        <div class="player-table-controls-right">
          <span style="color: #94a3b8; font-size: 11px;">Click column headers to sort â€¢ Hover headers to hide columns â€¢ Click row to hide</span>
        </div>
      </div>

      <div class="player-table-wrapper">
        <table id="player-detail-table" class="player-detail-table">
          <thead>
            <tr>
              <th data-col="name">Player <span class="hide-col-btn" data-hide-col="name">âœ•</span></th>
              <th data-col="positions" title="Position">Pos <span class="hide-col-btn" data-hide-col="positions">âœ•</span></th>
              <th data-col="apps" title="Appearances">Apps <span class="hide-col-btn" data-hide-col="apps">âœ•</span></th>
              <th data-col="rating" title="Average Rating">Rating <span class="hide-col-btn" data-hide-col="rating">âœ•</span></th>
              <th data-col="goals" title="Goals">G <span class="hide-col-btn" data-hide-col="goals">âœ•</span></th>
              <th data-col="assists" title="Assists">A <span class="hide-col-btn" data-hide-col="assists">âœ•</span></th>
              <th data-col="goalContribution" title="Goal Contribution (Goals + Assists)">G+A <span class="hide-col-btn" data-hide-col="goalContribution">âœ•</span></th>
              <th data-col="xg" title="Expected Goals">xG <span class="hide-col-btn" data-hide-col="xg">âœ•</span></th>
              <th data-col="xgDiff" title="xG Overperformance (Goals - xG)">xGÂ± <span class="hide-col-btn" data-hide-col="xgDiff">âœ•</span></th>
              <th data-col="conversionRate" title="Goal Conversion Rate %">Conv% <span class="hide-col-btn" data-hide-col="conversionRate">âœ•</span></th>
              <th data-col="xgPerShot" title="Expected Goals per Shot">xG/Shot <span class="hide-col-btn" data-hide-col="xgPerShot">âœ•</span></th>
              <th data-col="shots" title="Shots">Shots <span class="hide-col-btn" data-hide-col="shots">âœ•</span></th>
              <th data-col="sot" title="Shots on Target">SoT <span class="hide-col-btn" data-hide-col="sot">âœ•</span></th>
              <th data-col="shotAcc" title="Shot Accuracy %">Shot% <span class="hide-col-btn" data-hide-col="shotAcc">âœ•</span></th>
              <th data-col="chancesCreated" title="Chances Created">Chances <span class="hide-col-btn" data-hide-col="chancesCreated">âœ•</span></th>
              <th data-col="keyPassRate" title="Key Pass Rate %">Key% <span class="hide-col-btn" data-hide-col="keyPassRate">âœ•</span></th>
              <th data-col="passes" title="Passes">Passes <span class="hide-col-btn" data-hide-col="passes">âœ•</span></th>
              <th data-col="passAcc" title="Pass Accuracy %">Pass% <span class="hide-col-btn" data-hide-col="passAcc">âœ•</span></th>
              <th data-col="crosses" title="Crosses">Cross <span class="hide-col-btn" data-hide-col="crosses">âœ•</span></th>
              <th data-col="crossAcc" title="Cross Accuracy %">Cross% <span class="hide-col-btn" data-hide-col="crossAcc">âœ•</span></th>
              <th data-col="dribbles" title="Successful Dribbles">Drib <span class="hide-col-btn" data-hide-col="dribbles">âœ•</span></th>
              <th data-col="dribbledPast" title="Dribbled Past">Drb Past <span class="hide-col-btn" data-hide-col="dribbledPast">âœ•</span></th>
              <th data-col="defDuels" title="Defensive Duel Win %">Def% <span class="hide-col-btn" data-hide-col="defDuels">âœ•</span></th>
              <th data-col="clearances" title="Clearances">Clear <span class="hide-col-btn" data-hide-col="clearances">âœ•</span></th>
              <th data-col="blocks" title="Shots Blocked">Blocks <span class="hide-col-btn" data-hide-col="blocks">âœ•</span></th>
              <th data-col="shotsIntercepted" title="Shots Intercepted (Offensive)">Sh Int <span class="hide-col-btn" data-hide-col="shotsIntercepted">âœ•</span></th>
              <th data-col="progressive" title="Progressive Actions (Accurate Passes + Dribbles)">Prog <span class="hide-col-btn" data-hide-col="progressive">âœ•</span></th>
              <th data-col="fouls" title="Fouls Committed">Fouls <span class="hide-col-btn" data-hide-col="fouls">âœ•</span></th>
              <th data-col="foulsSuffered" title="Fouls Suffered">FS <span class="hide-col-btn" data-hide-col="foulsSuffered">âœ•</span></th>
              <th data-col="yc" title="Yellow Cards">YC <span class="hide-col-btn" data-hide-col="yc">âœ•</span></th>
              <th data-col="rc" title="Red Cards">RC <span class="hide-col-btn" data-hide-col="rc">âœ•</span></th>
              <th data-col="ownGoals" title="Own Goals">OG <span class="hide-col-btn" data-hide-col="ownGoals">âœ•</span></th>
              <th data-col="saves" title="Saves">Saves <span class="hide-col-btn" data-hide-col="saves">âœ•</span></th>
              <th data-col="goalsConceded" title="Goals Conceded">GC <span class="hide-col-btn" data-hide-col="goalsConceded">âœ•</span></th>
            </tr>
          </thead>
          <tbody id="player-detail-body"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div id="matches-section" class="matches-section">
    <div class="matches-header">
      <h2 id="matches-title">Match History</h2>
      
      <div class="matches-header-controls">
        <div class="match-filter-controls">
          <button class="filter-btn active" data-filter="all">All Matches</button>
          <button class="filter-btn" data-filter="wins">Wins Only</button>
          <button class="filter-btn" data-filter="draws">Draws Only</button>
          <button class="filter-btn" data-filter="losses">Losses Only</button>
        </div>
        <button id="download-csv-btn" class="btn btn-secondary">ğŸ“¥ Download CSV</button>
      </div>
    </div>
    <div class="matches-container" id="matches-container"></div>
  </div>

  <div class="footer">
    <p>Built for the MFL community. <a href="https://discord.com/users/rickyhyde" target="_blank" class="footer-link">Suggestions? Contact rickyhyde on Discord</a></p>
  </div>

  <script src="js/state.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/api.js"></script>
  <script src="js/render.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
